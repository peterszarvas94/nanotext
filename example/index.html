<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nanotext</title>

    <script type="module">
      import { init, insertImage } from "../src/nanotext.ts";
      import "../src/nanotext.css";
      import contentHtml from "./content.html?raw";

      // you should store image and get stored URL, not convert it to base64, this is only for demo
      function toBase64(file) {
        return new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.onload = () => resolve(reader.result);
          reader.onerror = reject;
          reader.readAsDataURL(file);
        });
      }

      const input = document.getElementById("upload");
      input.addEventListener("change", async () => {
        const file = input.files[0];
        if (file && file.name !== "") {
          const url = await toBase64(file);
          insertImage(url);
        }
      });

      // Initialize editor with imported content
      const editor = init({
        element: document.getElementById("editor"),
        content: contentHtml,
        onChange: (html) => {
          document.getElementById("output").textContent = html;
        },
        handleImageClick: () => {
          input.click();
        },
      });
    </script>
  </head>
  <body>
    <div id="editor"></div>

    <h2>Output:</h2>
    <output id="output"></output>

    <input id="upload" type="file" accept="image/*" style="display: none" />
  </body>
</html>
